## Простой онлайн магазин игрушек.
Это просто попытка расширить свои знания. Мои прошлые "изыскания" были основаны
на своей реализации сервера аутентификации и авторизации с протоколом OAuth2, 
и на межсервисном взаимодействии посредством Feign.

Здесь в качестве сервера авторизации используется Keycloak. А для обмена данными между 
микросервисами используется RabbitMQ. 

## Подготовка к работе.
Вначале [устанавливаем и настраиваем контейнер с программами Keycloak, MySQL и RabbitMQ](Docker.md)


## Переменные окружения.
Для развертывания в продакшн необходимо установить переменную среды окружения:
`OAUTH2_BASE_ISSUER_URI=<адрес сервера Keycloak>:порт`

Также необходимо задать пути для пользовательской авторизации:

`OAUTH2_BASE_AUTH_URI=<базовый адрес клиента>:порт`

Для Эврики:

`EUREKA_SERVER_URL=<адрес сервера Eureka>/eureka`

***Например***:
```
OAUTH2_BASE_ISSUER_URI=http://192.168.1.179:8080
OAUTH2_BASE_AUTH_URI=http://192.168.1.179:9000
EUREKA_SERVER_URL=http://192.168.1.179:7777/eureka
```


## Spring Cloud Bus + RabbitMQ (с Management Plugin)

Порт 5672 — стандартный порт для AMQP-протокола.

Порт 15672 — для веб-интерфейса RabbitMQ Management.

Админка соответственно: http://localhost:15672

Пароль и логин (задается в `.env.rabbitmq`): `admin`


## MySql
Настройки задаются в .env.mysql. 
Для ручного администрирования можно зайти под `root` в контейнере:
```shell
mysql -uroot -padmin
```


## Микросервисы.
### Catalog-service.
Базовый путь к изображениям задан в переменной app.images-path. Окончательный путь формируется как:
{app.images-path}/{productId}/{filename.pic}
где: productId - уникальный ID товара.
При удалении товара удаляется весь подкаталог с содержимым.

